"use strict";(self.webpackChunkcommerce_testing=self.webpackChunkcommerce_testing||[]).push([[133],{86929:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return m},default:function(){return g}});var n=a(58168),i=a(80045),o=(a(88763),a(15680)),s=a(83407);const d=["components"],m={},r=(c="InlineAlert",function(e){return console.warn("Component "+c+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.mdx)("div",e)});var c;const p={_frontmatter:m},l=s.A;function g(e){let{components:t}=e,a=(0,i.A)(e,d);return(0,o.mdx)(l,(0,n.A)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("h1",{id:"static-analysis"},"Static analysis"),(0,o.mdx)("p",null,"This topic provides steps to set up most static analyzers that are used in our build pipeline to work in your local PhpStorm environment. This guide is written specifically for those using PhpStorm on macOS."),(0,o.mdx)("h2",{id:"before-you-begin"},"Before you begin"),(0,o.mdx)("p",null,"If you have not already, verify that ",(0,o.mdx)("inlineCode",{parentName:"p"},"node")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"npm")," are installed. Then, in the application root directory, run ",(0,o.mdx)("inlineCode",{parentName:"p"},"npm install"),".  After installation, ensure there is a ",(0,o.mdx)("inlineCode",{parentName:"p"},"node_modules")," directory in the root of your project before proceeding."),(0,o.mdx)(r,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,'For all of the static configuration installations below involving the PhpStorm Preferences dialog, make sure you are clicking the "Apply" button before clicking "OK" to close the Preferences dialog.'),(0,o.mdx)("h2",{id:"javascript-code-style-check"},"JavaScript Code Style check"),(0,o.mdx)(r,{variant:"warning",slots:"text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,(0,o.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/jscs"},"JSCS package has been deprecated")," and ",(0,o.mdx)("a",{parentName:"p",href:"https://eslint.org/blog/2016/04/welcoming-jscs-to-eslint"},"merged with ESLint"),"."),(0,o.mdx)("h3",{id:"eslint"},"ESLint"),(0,o.mdx)(r,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"JavaScript code analysis is done through ",(0,o.mdx)("a",{parentName:"p",href:"https://developer.adobe.com/commerce/php/coding-standards/js/#eslint-code-analysis"},"ESLint"),".\nThe ESLint rules are set up in ",(0,o.mdx)("inlineCode",{parentName:"p"},"magento-coding-standard"),", which is installed on Magento2 via ",(0,o.mdx)("inlineCode",{parentName:"p"},"composer")," since it's a development dependency."),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Go to PhpStorm preferences > Languages & Frameworks > JavaScript > Code Quality Tools > ESLint."),(0,o.mdx)("li",{parentName:"ol"},"Click ",(0,o.mdx)("strong",{parentName:"li"},"Manual ESLint configuration"),"."),(0,o.mdx)("li",{parentName:"ol"},"Fill in the adjacent input fields with the path to your node binary (the result of outputting ",(0,o.mdx)("inlineCode",{parentName:"li"},"which node")," in your terminal)."),(0,o.mdx)("li",{parentName:"ol"},"Enter the path to your ESLint package: ",(0,o.mdx)("inlineCode",{parentName:"li"},"[magento_root]/node_modules/eslint")),(0,o.mdx)("li",{parentName:"ol"},"Click ",(0,o.mdx)("strong",{parentName:"li"},"Configuration File")," and in the adjacent input field enter the path to the ESLint file the application uses, which is located in ",(0,o.mdx)("inlineCode",{parentName:"li"},"vendor/magento/magento-coding-standard/eslint/.eslintrc-magento"),".")),(0,o.mdx)(r,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,o.mdx)("p",null,"On macOS systems, you may not be able to choose a file with a leading dot. You can rename the configuration file and remove the dot: ",(0,o.mdx)("inlineCode",{parentName:"p"},"cp vendor/magento/magento-coding-standard/eslint/.eslintrc-magento vendor/magento/magento-coding-standard/eslint/eslintrc-magento")),(0,o.mdx)("p",null,"See the image below for example configuration:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"38.4375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/5530d/static-eslint.webp 320w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/0c8fb/static-eslint.webp 640w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/94b1e/static-eslint.webp 1280w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/ebc82/static-eslint.webp 1454w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/dd4a7/static-eslint.png 320w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/0f09e/static-eslint.png 640w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/bbbf7/static-eslint.png 1280w","/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/2a660/static-eslint.png 1454w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-testing/static/acf73268657e6b158457da03b2d0d15b/bbbf7/static-eslint.png",alt:"ESLint",title:"ESLint",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"To verify it works, in any JS file add ",(0,o.mdx)("inlineCode",{parentName:"p"},"/** Hello world */")," as a doc comment to any method, and you should see a warning about the comment being on one line."),(0,o.mdx)("h2",{id:"phpcs"},"PHPCS"),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Go to PhpStorm preferences > Languages & Frameworks > PHP > Quality Tools > PHP_CodeSniffer."),(0,o.mdx)("li",{parentName:"ol"},"Click the ",(0,o.mdx)("inlineCode",{parentName:"li"},"...")," button to bring up another configuration modal."),(0,o.mdx)("li",{parentName:"ol"},"Enter the PHP_CodeSniffer path: ",(0,o.mdx)("inlineCode",{parentName:"li"},"[magento_root]/vendor/bin/phpcs"))),(0,o.mdx)("h3",{id:"configuring-for-magento-coding-standard"},"Configuring for Magento Coding Standard"),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Go to the ",(0,o.mdx)("a",{parentName:"li",href:"https://github.com/magento/magento-coding-standard"},"Magento Coding Standard GitHub Repository")),(0,o.mdx)("li",{parentName:"ol"},"Follow instructions within the readme to install the Magento Coding Standard for PHPCS.  Verify it is installed with ",(0,o.mdx)("inlineCode",{parentName:"li"},"vendor/bin/phpcs -i"),".  You should see ",(0,o.mdx)("inlineCode",{parentName:"li"},"Magento2")," in the output."),(0,o.mdx)("li",{parentName:"ol"},"Go to PhpStorm preferences > Editor > Inspections, and in the adjacent window go to PHP > Quality Tools > PHP_CodeSniffer validation."),(0,o.mdx)("li",{parentName:"ol"},"Under ",(0,o.mdx)("strong",{parentName:"li"},"Coding Standard")," dropdown, select ",(0,o.mdx)("inlineCode",{parentName:"li"},"Magento2"),".")),(0,o.mdx)("p",null,"See the image below for example configuration:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"65.9375%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/5530d/static-codesniff.webp 320w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/0c8fb/static-codesniff.webp 640w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/94b1e/static-codesniff.webp 1280w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/59189/static-codesniff.webp 1529w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/dd4a7/static-codesniff.png 320w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/0f09e/static-codesniff.png 640w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/bbbf7/static-codesniff.png 1280w","/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/ce240/static-codesniff.png 1529w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-testing/static/280a1e46292fc3645f30b53ce6535ef6/bbbf7/static-codesniff.png",alt:"PHPCS",title:"PHPCS",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"To verify it works, add the following PHP snippet: ",(0,o.mdx)("inlineCode",{parentName:"p"},"$base = basename($_SERVER['SCRIPT_FILENAME']);"),".  You should see a warning that the use of ",(0,o.mdx)("inlineCode",{parentName:"p"},"basename")," is forbidden, as well as the use of ",(0,o.mdx)("em",{parentName:"p"},"superglobals"),"."),(0,o.mdx)("h2",{id:"phpmd"},"PHPMD"),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Go to PhpStorm preferences > Languages & Frameworks > PHP > Quality Tools > Mess Detector."),(0,o.mdx)("li",{parentName:"ol"},"Click the ",(0,o.mdx)("inlineCode",{parentName:"li"},"...")," button to bring up another configuration modal."),(0,o.mdx)("li",{parentName:"ol"},"Enter the PHP Mess Detector path: ",(0,o.mdx)("inlineCode",{parentName:"li"},"[magento_root]/vendor/phpmd/phpmd/src/bin/phpmd")),(0,o.mdx)("li",{parentName:"ol"},"Go to PhpStorm preferences > Editor > Inspections and in the adjacent window go to  > PHP > Quality Tools > PHP Mess Detector validation."),(0,o.mdx)("li",{parentName:"ol"},"Under custom rulesets, add the path to the PHPMD ruleset the application uses: ",(0,o.mdx)("inlineCode",{parentName:"li"},"[magento_root]/dev/tests/static/testsuite/Magento/Test/Php/_files/phpmd/ruleset.xml"))),(0,o.mdx)("p",null,"See the image below for example configuration:"),(0,o.mdx)("p",null,(0,o.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px"}},"\n      ",(0,o.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"55.00000000000001%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,o.mdx)("picture",{parentName:"span"},"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/5530d/static-md.webp 320w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/0c8fb/static-md.webp 640w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/94b1e/static-md.webp 1280w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/a9c0c/static-md.webp 1916w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/webp"}),"\n          ",(0,o.mdx)("source",{parentName:"picture",srcSet:["/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/dd4a7/static-md.png 320w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/0f09e/static-md.png 640w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/bbbf7/static-md.png 1280w","/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/db5ee/static-md.png 1916w"],sizes:"(max-width: 1280px) 100vw, 1280px",type:"image/png"}),"\n          ",(0,o.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/commerce-testing/static/394d4ffef320bfd5e095c7b18d534e2e/bbbf7/static-md.png",alt:"PHPMD",title:"PHPMD",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,o.mdx)("p",null,"To verify it works, add an unused private method to a class, and you should see a warning from PHPMD about it not being used."))}g.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guide-static-analysis-md-5417a4102e2a8a29320c.js.map